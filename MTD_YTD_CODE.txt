法1.
WITH CTE AS (
SELECT CONVERT(VARCHAR(8), [OrderDate], 112) YYYYMMDD
      ,SUM([SalesAmount]) SalesAmount
  FROM [AdventureWorksDW2019].[dbo].[FactResellerSales]
  GROUP BY CONVERT(VARCHAR(8), [OrderDate], 112)
  )

SELECT YYYYMMDD, 
SalesAmount, 
SUM(SalesAmount) OVER(PARTITION BY SUBSTRING(YYYYMMDD, 1,6) ORDER BY YYYYMMDD ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) MTD,
SUM(SalesAmount) OVER(PARTITION BY SUBSTRING(YYYYMMDD, 1,4) ORDER BY YYYYMMDD ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) YTD
FROM CTE
ORDER BY YYYYMMDD

法2. 
WITH CTE AS (
SELECT CONVERT(VARCHAR(8), [OrderDate], 112) YYYYMMDD
      ,SUM([SalesAmount]) SalesAmount
  FROM [AdventureWorksDW2019].[dbo].[FactResellerSales]
  GROUP BY CONVERT(VARCHAR(8), [OrderDate], 112)
  )

SELECT A.YYYYMMDD, A.SalesAmount, SUM(DISTINCT B.SalesAmount) MTD, SUM(DISTINCT C.SalesAmount) YTD
FROM CTE A
LEFT JOIN CTE B
ON SUBSTRING(A.YYYYMMDD, 1, 6) = SUBSTRING(B.YYYYMMDD, 1, 6) 
LEFT JOIN CTE C
ON SUBSTRING(A.YYYYMMDD, 1, 4) = SUBSTRING(C.YYYYMMDD, 1, 4) 
WHERE A.YYYYMMDD >= B.YYYYMMDD AND A.YYYYMMDD >= C.YYYYMMDD AND B.YYYYMMDD >= C.YYYYMMDD
GROUP BY A.YYYYMMDD, A.SalesAmount
ORDER BY A.YYYYMMDD, A.SalesAmount