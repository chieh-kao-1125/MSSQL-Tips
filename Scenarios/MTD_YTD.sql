--Solution 1
WITH CTE AS (
SELECT CONVERT(VARCHAR(8), [Date], 112) YYYYMMDD
      ,SUM([Amount]) Amount
  FROM [dbo].[Table]
  GROUP BY CONVERT(VARCHAR(8), [Date], 112)
  )

SELECT YYYYMMDD, 
Amount, 
SUM(Amount) OVER(PARTITION BY SUBSTRING(YYYYMMDD, 1,6) ORDER BY YYYYMMDD ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) MTD,
SUM(Amount) OVER(PARTITION BY SUBSTRING(YYYYMMDD, 1,4) ORDER BY YYYYMMDD ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) YTD
FROM CTE
ORDER BY YYYYMMDD

--Solution 2
WITH CTE AS (
SELECT CONVERT(VARCHAR(8), [Date], 112) YYYYMMDD
      ,SUM([Amount]) Amount
  FROM [dbo].[Table]
  GROUP BY CONVERT(VARCHAR(8), [Date], 112)
  )

SELECT A.YYYYMMDD, A.Amount, SUM(DISTINCT B.Amount) MTD, SUM(DISTINCT C.Amount) YTD
FROM CTE A
LEFT JOIN CTE B
ON SUBSTRING(A.YYYYMMDD, 1, 6) = SUBSTRING(B.YYYYMMDD, 1, 6) 
LEFT JOIN CTE C
ON SUBSTRING(A.YYYYMMDD, 1, 4) = SUBSTRING(C.YYYYMMDD, 1, 4) 
WHERE A.YYYYMMDD >= B.YYYYMMDD AND A.YYYYMMDD >= C.YYYYMMDD AND B.YYYYMMDD >= C.YYYYMMDD
GROUP BY A.YYYYMMDD, A.Amount
ORDER BY A.YYYYMMDD, A.Amount
